import fitz  # PyMuPDF
import re

pdf_path = "pdfextract.pdf"
doc = fitz.open(pdf_path)

# Detect start of section headers
section_start_pattern = re.compile(r'^\d+(\.\d+)*\s')

# Detect ISA at end (may wrap to next line)
isa_pattern = re.compile(r'ISA\s\|\s\d+')

section_headers = []

for page_number in range(min(30, len(doc))):
    page = doc[page_number]
    lines = page.get_text().split('\n')
    i = 0
    while i < len(lines):
        line = lines[i].strip()

        # Start of a section header
        if section_start_pattern.match(line):
            # Try to combine with next line if it's a continuation (e.g., ISA is in the next line)
            combined_line = line
            j = i + 1
            while j < len(lines):
                next_line = lines[j].strip()
                combined_line += ' ' + next_line
                if '[ISA' in next_line:
                    break
                j += 1
            section_headers.append(combined_line.strip())
            i = j  # Skip to the line after
        else:
            i += 1

doc.close()

# Print results
for header in section_headers:
    print(header)
