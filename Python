import pdfplumber
import re

pdf_path = r"C:\path\to\your\file.pdf"
page_number = 15  # start from logical page 15

with pdfplumber.open(pdf_path) as pdf:
    for page in pdf.pages[14:100]:  # 0-based index: page 14 = page 15
        text = page.extract_text()
        if not text:
            page_number += 1
            continue

        lines = text.splitlines()

        i = 0
        while i < len(lines):
            line = lines[i].strip()

            # Check if this line or the next forms the trigger
            match_found = False
            if "How do we comply with the Standards?" in line and "[ISA | KAEGHDWC]" in line:
                match_found = True
                i += 1
            elif i + 1 < len(lines):
                combined = line + " " + lines[i + 1].strip()
                if "How do we comply with the Standards?" in combined and "[ISA | KAEGHDWC]" in combined:
                    match_found = True
                    i += 2  # Skip the two lines forming the trigger
                else:
                    i += 1
            else:
                i += 1

            if match_found:
                # Look ahead for the next section header (starts with number and ends with ])
                section_lines = []
                while i < len(lines):
                    l = lines[i].strip()
                    section_lines.append(l)

                    # Check if line ends with ']'
                    if re.search(r"ISA\s*\|\s*\d+$", l):
                        break

                    i += 1

                # Now combine the section header lines into a single string
                section_title = ' '.join(section_lines).strip()

                # Match section number pattern (e.g., 1, 1.1, 2.3.4)
                if re.match(r"^\d+(\.\d+)*\s+.*ISA\s*\|\s*\d+$", section_title):
                    print(f"[Page {page_number}] Section Title: {section_title}")
