using System;
using System.Collections.Generic;
using UglyToad.PdfPig;

class Program
{
    static void Main(string[] args)
    {
        var pdfPath = @"C:\path\to\your\file.pdf";  // Update with your path
        var trigger = "How do we comply with the Standards?";
        var isa = "[ISA | KAEGHDWC]";

        // Step 1: Load all lines from pages 15â€“500
        var allLines = new List<(string Line, int PageNumber)>();

        using (var pdf = PdfDocument.Open(pdfPath))
        {
            for (int pageNum = 15; pageNum <= 500; pageNum++)
            {
                var page = pdf.GetPage(pageNum);
                var lines = page.Text.Split('\n');

                foreach (var rawLine in lines)
                {
                    var clean = rawLine.Trim();
                    if (!string.IsNullOrWhiteSpace(clean))
                        allLines.Add((clean, pageNum));
                }
            }
        }

        Console.WriteLine("Finished loading all lines. Starting trigger search...\n");

        // Step 2: Process loaded lines
        for (int i = 0; i < allLines.Count; i++)
        {
            var (line, page) = allLines[i];

            // Case 1: Trigger all in one line
            if (line.Contains(trigger) && line.Contains(isa))
            {
                Console.WriteLine($"[Page {page}, Line {i}] {line}");
            }

            // Case 2: Trigger split across two lines
            if (i + 1 < allLines.Count)
            {
                var (nextLine, _) = allLines[i + 1];
                var combined = line + " " + nextLine;

                if (combined.Contains(trigger) && combined.Contains(isa))
                {
                    Console.WriteLine($"[Page {page}, Lines {i}-{i + 1}] {combined}");
                }
            }
        }

        Console.WriteLine("\nDone.");
    }
}
